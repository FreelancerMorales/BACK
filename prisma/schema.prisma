generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id        String         @id
  nombre    String
  correo    String         @unique
  foto      String?
  activo    Boolean  @default(true)
  creadoEn  DateTime       @default(now())

  cuentas        Cuenta[]
  categorias     Categoria[]
  transacciones  Transaccion[]
}

model Cuenta {
  id            Int             @id @default(autoincrement())
  nombre        String
  tipo          String
  usuarioId     String
  usuario       Usuario         @relation(fields: [usuarioId], references: [id])

  transacciones Transaccion[]
}

model TipoMovimiento {
  id            Int             @id @default(autoincrement())
  nombre        String          @unique

  categorias     Categoria[]
  transacciones  Transaccion[]
}

model Categoria {
  id              Int             @id @default(autoincrement())
  nombre          String
  tipoMovimientoId Int
  tipoMovimiento  TipoMovimiento  @relation(fields: [tipoMovimientoId], references: [id])

  usuarioId       String
  usuario         Usuario         @relation(fields: [usuarioId], references: [id])

  transacciones   Transaccion[]
}

model Transaccion {
  id              Int             @id @default(autoincrement())
  monto           Float
  descripcion     String?
  fecha           DateTime        @default(now())

  cuentaId        Int
  cuenta          Cuenta          @relation(fields: [cuentaId], references: [id])

  categoriaId     Int
  categoria       Categoria       @relation(fields: [categoriaId], references: [id])

  tipoMovimientoId Int
  tipoMovimiento   TipoMovimiento @relation(fields: [tipoMovimientoId], references: [id])

  usuarioId       String
  usuario         Usuario         @relation(fields: [usuarioId], references: [id])
}